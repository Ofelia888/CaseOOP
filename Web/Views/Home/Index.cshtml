@{
    ViewData["Title"] = "Plukliste behandling";
}

<p>Page <span id="page">@((int)ViewData["Page"]! + 1)</span> of @(ViewData["Pages"])</p>

<button>Quit</button>
<button>Aflust</button>
<button id="pluckListView_previous">Forrige</button>
<button id="pluckListView_next">Næste</button>
<button>Genindlæs</button>
<button>Åbn print</button>
<button>Scan varer</button>

<div class="mt-3 p-2" style="border: 1px solid #888;" id="pluckListView"></div>

<script>
    $(document).ready(function () {
        let processing = false;
        $("#pluckListView_next").click(function () {
            if (processing) return;
            let page = $("#page");
            let index = parseInt(page.html());
            if (index >= @ViewData["Pages"]) return;
            processing = true;
            $.ajax({
                url: "/Home/GetPluckList",
                type: "GET",
                data: { index: index }
            }).done(function (view) {
                page.html(index + 1);
                $("#pluckListView").html(view);
                processing = false;
            }).fail(function () {
                processing = false;
            })
        })
        $("#pluckListView_previous").click(function () {
            if (processing) return;
            let page = $("#page");
            let index = parseInt(page.html());
            if (index <= 1) return;
            processing = true;
            $.ajax({
                url: "/Home/GetPluckList",
                type: "GET",
                data: { index: index - 2 }
            }).done(function (view) {
                page.html(index - 1);
                $("#pluckListView").html(view);
                processing = false;
            }).fail(function () {
                processing = false;
            })
        })
        let page = parseInt($("#page").html());
        $.ajax({
            url: "/Home/GetPluckList",
            type: "GET",
            data: { index: page - 1 }
        }).done(function (view) {
            $("#pluckListView").html(view);
        })
    })
</script>
